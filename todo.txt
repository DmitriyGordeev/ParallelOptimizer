1. заменить везде .loc[...] = ... на .at[...] = ... - проверить есть ли warnings
2. можно ли future-объект просто как отложенное действие без создания потока?